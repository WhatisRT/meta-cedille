module Nat.

importModule Product.

elet Nat : * := ∀ X : *. X -> (X -> X) -> X.

elet zero : Nat := Λ X : *. λ z : X. λ s : X -> X. z.
elet suc (n : Nat) : Nat := Λ X : *. λ z : X. λ s : X -> X. s $ n ?X z s.

elet recursionNat [X : *] (rz : X) (rs : Nat -> X -> X) (n : Nat) : X :=
  pr2 ?Nat ?X $ n ?(Nat × X)
    (zero ; rz)
    (λ r : Nat × X. suc (pr1 ?Nat ?X r) ; rs (pr1 ?Nat ?X r) (pr2 ?Nat ?X r)).

endModule.

runMeta compileNames "Nat".
