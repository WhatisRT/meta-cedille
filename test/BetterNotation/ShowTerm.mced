--------------------------------------------------------------------------------
-- Defines showTerm
--
-- TODO: move somewhere else?
--------------------------------------------------------------------------------

b-let showVar (v : init$var) : String := v ?String (λ s : String. s) (λ i : init$index. "INDEX").
b-let showSort (s : init$sort) : String := s ?String "*" "□".
b-let showBinder (b : Binder) : String := b ?String "λ" "Λ" "Π" "∀".

b-let showTerm (t : Term) : String :=
  t ?String
    (λ v : init$var. showVar v)
    (λ s : init$sort. showSort s)
    (λ b : Binder. λ n : String. λ T, t : String.
      stringConcat [String| showBinder b, " ", n, " : ", T, ". ", t])
    (λ t : String. λ l : List (Product Bool String).
      stringConcat (cons ?String t
                          (map ?(Product Bool String) ?String
                               (λ bs : Product Bool String.
                                 stringConcat [String| ifthenelse ?String (pr1 ?Bool ?String bs) " ?" " ",
                                                             "(", pr2 ?Bool ?String bs, ")"]) l)))
    (λ t : String. stringConcat [String| "γ{", t, "}"]).